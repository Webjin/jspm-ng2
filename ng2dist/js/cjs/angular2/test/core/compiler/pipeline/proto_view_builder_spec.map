{"version":3,"sources":["proto_view_builder_spec.js","@traceur/generated/TemplateParser/21","@traceur/generated/TemplateParser/19","@traceur/generated/TemplateParser/11","@traceur/generated/TemplateParser/2","@traceur/generated/TemplateParser/20","@traceur/generated/TemplateParser/5","@traceur/generated/TemplateParser/1","@traceur/generated/TemplateParser/13","@traceur/generated/TemplateParser/15","@traceur/generated/TemplateParser/17","@traceur/generated/TemplateParser/16","@traceur/generated/TemplateParser/8","@traceur/generated/TemplateParser/10"],"names":[],"mappings":"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","file":"/Users/crush/Documents/learning_js/angular/modules/angular2/test/core/compiler/pipeline/proto_view_builder_spec.js","sourceRoot":"/Users/crush/Documents/learning_js/angular/modules/angular2/test/core/compiler/pipeline/","sourcesContent":["import {describe, beforeEach, it, expect, iit, ddescribe, el} from 'angular2/test_lib';\nimport {isPresent} from 'angular2/src/facade/lang';\nimport {DOM} from 'angular2/src/dom/dom_adapter';\nimport {dynamicChangeDetection} from 'angular2/change_detection';\nimport {ElementBinder} from 'angular2/src/core/compiler/element_binder';\nimport {ProtoViewBuilder} from 'angular2/src/core/compiler/pipeline/proto_view_builder';\nimport {CompilePipeline} from 'angular2/src/core/compiler/pipeline/compile_pipeline';\nimport {CompileElement} from 'angular2/src/core/compiler/pipeline/compile_element';\nimport {CompileStep} from 'angular2/src/core/compiler/pipeline/compile_step'\nimport {CompileControl} from 'angular2/src/core/compiler/pipeline/compile_control';\nimport {NativeShadowDomStrategy} from 'angular2/src/core/compiler/shadow_dom_strategy';\nimport {MapWrapper} from 'angular2/src/facade/collection';\n\nexport function main() {\n  describe('ProtoViewBuilder', () => {\n    function createPipeline(variableBindings = null) {\n      return new CompilePipeline([new MockStep((parent, current, control) => {\n        if (isPresent(DOM.getAttribute(current.element, 'viewroot'))) {\n          current.isViewRoot = true;\n        }\n        if (isPresent(DOM.getAttribute(current.element, 'var-binding'))) {\n          current.variableBindings = MapWrapper.createFromStringMap(variableBindings);\n        }\n        current.inheritedElementBinder = new ElementBinder(null, null, null);\n      }), new ProtoViewBuilder(dynamicChangeDetection, new NativeShadowDomStrategy(null))]);\n    }\n\n    it('should not create a ProtoView when the isViewRoot flag is not set', () => {\n      var results = createPipeline().process(el('<div></div>'));\n      expect(results[0].inheritedProtoView).toBe(null);\n    });\n\n    it('should create a ProtoView when the isViewRoot flag is set', () => {\n      var viewRootElement = el('<div viewroot></div>');\n      var results = createPipeline().process(viewRootElement);\n      expect(results[0].inheritedProtoView.element).toBe(viewRootElement);\n    });\n\n    it('should inherit the ProtoView down to children that have no isViewRoot set', () => {\n      var viewRootElement = el('<div viewroot><span></span></div>');\n      var results = createPipeline().process(viewRootElement);\n      expect(results[0].inheritedProtoView.element).toBe(viewRootElement);\n      expect(results[1].inheritedProtoView.element).toBe(viewRootElement);\n    });\n\n    it('should save ProtoView into the elementBinder of parent element', () => {\n      var element = el('<div viewroot><template><a viewroot></a></template></div>');\n      var results = createPipeline().process(element);\n      expect(results[1].inheritedElementBinder.nestedProtoView).toBe(results[2].inheritedProtoView);\n    });\n\n    it('should bind variables to the nested ProtoView', () => {\n      var element = el('<div viewroot><template var-binding><a viewroot></a></template></div>');\n      var results = createPipeline({\n        'var1': 'map1',\n        'var2': 'map2'\n      }).process(element);\n      var npv = results[1].inheritedElementBinder.nestedProtoView;\n      expect(npv.variableBindings).toEqual(MapWrapper.createFromStringMap({\n        'var1': 'map1',\n        'var2': 'map2'\n      }));\n    });\n\n    it('should mark variables in the proto view context locals', () => {\n      var element = el('<div viewroot><p var-binding></p></div>');\n\n      var results = createPipeline({\n        'var1': 'map1',\n        'var2': 'map2'\n      }).process(element);\n\n      var protoView = results[0].inheritedProtoView;\n      expect(protoView.protoContextLocals).toEqual(MapWrapper.createFromStringMap({\n        'map2': null,\n        'map1': null\n      }));\n    });\n\n    describe('errors', () => {\n\n      it('should not allow multiple nested ProtoViews for the same parent element', () => {\n        var element = el('<div viewroot><template><a viewroot></a><a viewroot></a></template></div>');\n        expect( () => {\n          createPipeline().process(element);\n        }).toThrowError('Only one nested view per element is allowed');\n      });\n\n    });\n\n  });\n}\n\nclass MockStep extends CompileStep {\n  processClosure:Function;\n  constructor(process) {\n    super();\n    this.processClosure = process;\n  }\n  process(parent:CompileElement, current:CompileElement, control:CompileControl) {\n    this.processClosure(parent, current, control);\n  }\n}\n","Object.defineProperties(module.exports, $__placeholder__0);","{get: $__placeholder__0}","get $__placeholder__0() { return $__placeholder__1; }","__esModule: true","{value: $__placeholder__0}","var __moduleName = $__placeholder__0;","($__placeholder__0 = require($__placeholder__1),\n        $__placeholder__2 && $__placeholder__3.__esModule && $__placeholder__4 || {default: $__placeholder__5})","var $__placeholder__0 = $__placeholder__1","$traceurRuntime.superConstructor($__placeholder__0).call($__placeholder__1)","var $__placeholder__0 = $__placeholder__1","($traceurRuntime.createClass)($__placeholder__0, $__placeholder__1, $__placeholder__2,\n                                       $__placeholder__3)","assert.argumentTypes($__placeholder__0)","Object.defineProperty($__placeholder__0, $__placeholder__1,\n        {get: function() {return $__placeholder__2}});"]}